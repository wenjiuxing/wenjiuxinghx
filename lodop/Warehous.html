<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">

<head>
    <script src='./jquery-2.1.1.min.js'></script>
    <script src='./LodopFuncs.js'></script>
    
    <script src='./DataOjbect.js'></script>
    <script src='./GetPrintValues.js'></script>
    <script src='./DoPrintModels.js'></script>

</head>
<style>
</style>

<body>
    <button onclick="Ware()" style='width:110px;height:32px;background:#1890ff;color:white;border:none;border-radius:3px;line-height: 20px'>打印</button>

</body>
<script>

    function Ware() {
        var selectedRow = JSON.parse(sessionStorage.selectedRows)
        var code = sessionStorage.warehouseCode
        var warehouseType = sessionStorage.warehouseType
        console.log(selectedRow)
        //大
        if (sessionStorage.WriteOff == "true") {
            if (selectedRow.length == 1) {
                doWarehouseReceiptPrint(0, sessionStorage.departmentName, JSON.parse(sessionStorage.factory), code, sessionStorage.companyName + "(冲销)", sessionStorage.typeprint)
            }
            for (var i = 0; i < selectedRow.length; i++) {
                (function(){
                    $.ajax({
                    url: 'http://api.wms.yncic.com/sys/wms/sysUacUsers/findDepartmentByUserName?userName=' + selectedRow[i].receiptCreateBy,
                    dataType: 'json',
                    type: 'Get',
                    async: false,
                    headers: {
                        'authorization': sessionStorage.getItem('token')
                    },
                    success: function (headsData) {
                        console.log(headsData)
                        doWarehouseReceiptPrint(1, headsData.departmentName, JSON.parse(sessionStorage.factory), selectedRow[i].warehouseCode, sessionStorage.companyName + "(冲销)", sessionStorage.typeprint)
                    }
                }) 

                    })(i)
               
            }
        } else {
            if (selectedRow.length == 1) {
                doWarehouseReceiptPrint(0, sessionStorage.departmentName, JSON.parse(sessionStorage.factory), code, sessionStorage.companyName, sessionStorage.typeprint)
            }
            else {
                for (var i = 0; i < selectedRow.length; i++) {
                    (function(){
                        $.ajax({
                        url: 'http://api.wms.yncic.com/sys/wms/sysUacUsers/findDepartmentByUserName?userName=' + selectedRow[i].receiptCreateBy,
                        dataType: 'json',
                        type: 'Get',
                        async: false,
                        headers: {
                            'authorization': sessionStorage.getItem('token')
                        },
                        success: function (headsData) {
                            console.log(headsData)
                            doWarehouseReceiptPrint(1, headsData.departmentName, JSON.parse(sessionStorage.factory), selectedRow[i].warehouseCode, sessionStorage.companyName, sessionStorage.typeprint)
                        }
                    })

                    })(i)
                   
                }
            }
        }
    }


</script>

</html>